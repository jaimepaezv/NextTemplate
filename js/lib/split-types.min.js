((t,e)=>{"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).SplitType=e()})(this,function(){function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function t(t,e,n){e&&r(t.prototype,e),n&&r(t,n)}function e(e,t){var n,r=Object.keys(e);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(e),t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)),r}function o(r){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?e(Object(o),!0).forEach(function(t){var e,n;e=r,n=o[t=t],t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(o)):e(Object(o)).forEach(function(t){Object.defineProperty(r,t,Object.getOwnPropertyDescriptor(o,t))})}return r}function v(t,e){return(t=>{if(Array.isArray(t))return t})(t)||((t,e)=>{if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t)){var n=[],r=!0,o=!1,i=void 0;try{for(var s,a=t[Symbol.iterator]();!(r=(s=a.next()).done)&&(n.push(s.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==a.return||a.return()}finally{if(o)throw i}}return n}})(t,e)||n(t,e)||(()=>{throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")})()}function w(t){return(t=>{if(Array.isArray(t))return i(t)})(t)||(t=>{if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)})(t)||n(t)||(()=>{throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")})()}function n(t,e){var n;if(t)return"string"==typeof t?i(t,e):"Map"===(n="Object"===(n=Object.prototype.toString.call(t).slice(8,-1))&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(t,e):void 0}function i(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function p(o,i){return Object.getOwnPropertyNames(Object(o)).reduce(function(t,e){var n=Object.getOwnPropertyDescriptor(Object(o),e),r=Object.getOwnPropertyDescriptor(Object(i),e);return Object.defineProperty(t,e,r||n)},{})}function d(t){return"string"==typeof t}function s(t){return Array.isArray(t)}function a(t){var e,t=0<arguments.length&&void 0!==t?t:{},n=p(t);return void 0!==n.types?e=n.types:void 0!==n.split&&(e=n.split),void 0!==e&&(n.types=(d(e)||s(e)?String(e):"").split(",").map(function(t){return String(t).trim()}).filter(function(t){return/((line)|(word)|(char))/i.test(t)})),(n.absolute||n.position)&&(n.absolute=n.absolute||/absolute/.test(t.position)),n}function O(t){t=d(t)||s(t)?String(t):"";return{none:!t,lines:/line/i.test(t),words:/word/i.test(t),chars:/char/i.test(t)}}function c(t){return null!==t&&"object"==typeof t}function B(t){return c(t)&&/^(1|3|11)$/.test(t.nodeType)}function j(t){return s(t)?t:null==t?[]:c(t)&&"number"==typeof(e=t.length)&&-1<e&&e%1==0?Array.prototype.slice.call(t):[t];var e}function l(t){var e=t;return j(e=d(t)?/^(#[a-z]\w+)$/.test(t.trim())?document.getElementById(t.trim().slice(1)):document.querySelectorAll(t):e).reduce(function(t,e){return[].concat(w(t),w(j(e).filter(B)))},[])}function u(){for(var t=arguments.length,e=0;e<t;e++){var n=e<0||arguments.length<=e?void 0:arguments[e];1===n.nodeType||11===n.nodeType?this.appendChild(n):this.appendChild(document.createTextNode(String(n)))}}function f(){for(;this.lastChild;)this.removeChild(this.lastChild);arguments.length&&this.append.apply(this,arguments)}function h(){for(var t=this.parentNode,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];var o=n.length;if(t)for(o||t.removeChild(this);o--;){var i=n[o];"object"!=typeof i?i=this.ownerDocument.createTextNode(i):i.parentNode&&i.parentNode.removeChild(i),o?t.insertBefore(this.previousSibling,i):t.replaceChild(i,this)}}"undefined"!=typeof Element&&(Element.prototype.append||(Element.prototype.append=u,DocumentFragment.prototype.append=u),Element.prototype.replaceChildren||(Element.prototype.replaceChildren=f,DocumentFragment.prototype.replaceChildren=f),Element.prototype.replaceWith||(Element.prototype.replaceWith=h,DocumentFragment.prototype.replaceWith=h));var F=Object.entries,y="_splittype",g={},I=0;function C(t,e,n){if(!c(t))return console.warn("[data.set] owner is not an object");var t=t[y]||(t[y]=++I),r=g[t]||(g[t]={});void 0===n?e&&Object.getPrototypeOf(e)===Object.prototype&&(g[t]=o(o({},r),e)):void 0!==e&&(r[e]=n)}function E(t,e){t=c(t)?t[y]:null,t=t&&g[t]||{};return void 0===e?t:t[e]}function S(t){var e=t&&t[y];e&&(delete t[e],delete g[e])}var m="\\ud800-\\udfff",b="\\u0300-\\u036f\\ufe20-\\ufe23",x="\\u20d0-\\u20f0",T="\\ufe0e\\ufe0f",L="[".concat(m,"]"),W="[".concat(b).concat(x,"]"),k="\\ud83c[\\udffb-\\udfff]",A="(?:".concat(W,"|").concat(k,")"),H="[^".concat(m,"]"),M="(?:\\ud83c[\\udde6-\\uddff]){2}",z="[\\ud800-\\udbff][\\udc00-\\udfff]",A="".concat(A,"?"),P="[".concat(T,"]?"),P=P+A+("(?:\\u200d(?:"+[H,M,z].join("|"))+")"+P+A+")*",A="(?:".concat(["".concat(H).concat(W,"?"),W,M,z,L].join("|"),"\n)"),V=RegExp("".concat(k,"(?=").concat(k,")|").concat(A).concat(P),"g"),q=RegExp("[".concat(["\\u200d",m,b,x,T].join(""),"]"));function U(t){return q.test(t)}function D(t,n){var r=document.createElement(t);return n&&Object.keys(n).forEach(function(t){var e=n[t],e=d(e)?e.trim():e;null!==e&&""!==e&&("children"===t?r.append.apply(r,w(j(e))):r.setAttribute(t,e))}),r}var N={splitClass:"",lineClass:"line",wordClass:"word",charClass:"char",types:["lines","words","chars"],absolute:!1,tagName:"div"};function X(t,s){var e,a=O((s=p(N,s)).types),c=s.tagName,n=t.nodeValue,l=document.createDocumentFragment(),u=[];return/^\s/.test(n)&&l.append(" "),e=function(t,e){e=1<arguments.length&&void 0!==e?e:" ";return(t?String(t):"").trim().replace(/\s+/g," ").split(e)}(n).reduce(function(t,e,n,r){var o,i;return a.chars&&(i=function(t,e){var n,e=1<arguments.length&&void 0!==e?e:"";return(t=null==(n=t)?"":String(n))&&d(t)&&!e&&U(t)?U(n=t)?n.match(V)||[]:n.split(""):t.split(e)}(e).map(function(t){t=D(c,{class:"".concat(s.splitClass," ").concat(s.charClass),style:"display: inline-block;",children:t});return C(t,"isChar",!0),u=[].concat(w(u),[t]),t})),a.words||a.lines?(C(o=D(c,{class:"".concat(s.wordClass," ").concat(s.splitClass),style:"display: inline-block; ".concat(a.words&&s.absolute?"position: relative;":""),children:a.chars?i:e}),{isWord:!0,isWordStart:!0,isWordEnd:!0}),l.appendChild(o)):i.forEach(function(t){l.appendChild(t)}),n<r.length-1&&l.append(" "),a.words?t.concat(o):t},[]),/\s$/.test(n)&&l.append(" "),t.replaceWith(l),{words:e,chars:u}}function Y(c,l,u){var t,e,p,d=O(l.types),n=l.tagName,r=c.getElementsByTagName("*"),f=[],h=[],y=null,o=[],i=c.parentElement,s=c.nextElementSibling,g=document.createDocumentFragment(),a=window.getComputedStyle(c),m=a.textAlign,b=.2*parseFloat(a.fontSize);return l.absolute&&(p={left:c.offsetLeft,top:c.offsetTop,width:c.offsetWidth},e=c.offsetWidth,t=c.offsetHeight,C(c,{cssWidth:c.style.width,cssHeight:c.style.height})),j(r).forEach(function(t){var e,n=t.parentElement===c,r=(e=t,l.absolute?(i=e.offsetParent,s=(r=v(u,2))[0],r=r[1],o=a=0,i&&i!==document.body&&(a=(i=i.getBoundingClientRect()).x+s,o=i.y+r),{width:(i=e.getBoundingClientRect()).width,height:i.height,top:i.y+r-o,left:i.x+s-a}):{top:n?e.offsetTop:null}),o=r.width,i=r.height,s=r.top,a=r.left;/^br$/i.test(t.nodeName)||(d.lines&&n&&((null===y||b<=s-y)&&(y=s,f.push(h=[])),h.push(t)),l.absolute&&C(t,{top:s,left:a,width:o,height:i}))}),i&&i.removeChild(c),d.lines&&(o=f.map(function(t){var s=D(n,{class:"".concat(l.splitClass," ").concat(l.lineClass),style:"display: block; text-align: ".concat(m,"; width: 100%;")}),a=(C(s,"isLine",!0),{height:0,top:1e4});return g.appendChild(s),t.forEach(function(t,e,n){var r=E(t),o=r.isWordEnd,i=r.top,n=n[e+1];a.height=Math.max(a.height,r.height),a.top=Math.min(a.top,i),s.appendChild(t),o&&E(n).isWordStart&&s.append(" ")}),l.absolute&&C(s,{height:a.height,top:a.top}),s}),d.words||function t(e){E(e).isWord?(S(e),e.replaceWith.apply(e,w(e.childNodes))):j(e.children).forEach(t)}(g),c.replaceChildren(g)),l.absolute&&(c.style.width="".concat(c.style.width||e,"px"),c.style.height="".concat(t,"px"),j(r).forEach(function(t){var e=E(t),n=e.isLine,r=e.top,o=e.left,i=e.width,e=e.height,s=E(t.parentElement),a=!n&&s.isLine;t.style.top="".concat(a?r-s.top:r,"px"),t.style.left="".concat(n?p.left:o-(a?p.left:0),"px"),t.style.height="".concat(e,"px"),t.style.width="".concat(n?p.width:i,"px"),t.style.position="absolute"})),i&&(s?i.insertBefore(c,s):i.appendChild(c)),o}var R=p(N,{});return t($,null,[{key:"clearData",value:function(){Object.keys(g).forEach(function(t){delete g[t]})}},{key:"setDefaults",value:function(t){return R=p(R,a(t)),N}},{key:"revert",value:function(t){l(t).forEach(function(t){var e=E(t),n=e.isSplit,r=e.cssWidth,o=e.cssHeight;n&&(t.innerHTML=e.html,t.style.width=r||"",t.style.height=o||"",S(t))})}},{key:"create",value:function(t,e){return new $(t,e)}},{key:"data",get:function(){return g}},{key:"defaults",get:function(){return R},set:function(t){R=p(R,a(t))}}]),t($,[{key:"split",value:function(t){var n=this,e=(this.revert(),this.elements.forEach(function(t){C(t,"html",t.innerHTML)}),this.lines=[],this.words=[],this.chars=[],[window.pageXOffset,window.pageYOffset]),r=(void 0!==t&&(this.settings=p(this.settings,a(t))),O(this.settings.types));r.none||(this.elements.forEach(function(t){C(t,"isRoot",!0);var t=function r(t,o){var e,n,i=t.nodeType,s={words:[],chars:[]};return/(1|3|11)/.test(i)?3===i&&/\S/.test(t.nodeValue)?X(t,o):((i=j(t.childNodes)).length&&(C(t,"isSplit",!0),!E(t).isRoot)&&(t.style.display="inline-block",t.style.position="relative",e=(e=t.nextSibling)?e.textContent:" ",n=(n=t.previousSibling)?n.textContent:" ",C(t,{isWordEnd:/\s$/.test(t=t.textContent||"")||/^\s/.test(e),isWordStart:/^\s/.test(t)||/\s$/.test(n)})),i.reduce(function(t,e){var n=(e=r(e,o)).words,e=e.chars;return{words:[].concat(w(t.words),w(n)),chars:[].concat(w(t.chars),w(e))}},s)):s}(t,n.settings),e=t.words,t=t.chars;n.words=[].concat(w(n.words),w(e)),n.chars=[].concat(w(n.chars),w(t))}),this.elements.forEach(function(t){(r.lines||n.settings.absolute)&&(t=Y(t,n.settings,e),n.lines=[].concat(w(n.lines),w(t)))}),this.isSplit=!0,window.scrollTo(e[0],e[1]),F(g).forEach(function(t){var t=v(t,2),e=t[0],t=t[1];t.isRoot&&t.isSplit||(g[e]=null,delete g[e])}))}},{key:"revert",value:function(){this.isSplit&&(this.lines=null,this.words=null,this.chars=null,this.isSplit=!1),$.revert(this.elements)}}]),$;function $(t,e){if(!(this instanceof $))throw new TypeError("Cannot call a class as a function");this.isSplit=!1,this.settings=p(R,a(e)),this.elements=l(t),this.split()}});